#The format and the meaning of the map file

= Introduction =
Frequently, one may be confused with the mandatory mapfile. However, it is rather simple and straightforward: this file simply shows the map between the lattice indices of an atom and its unique id in the simulation box.

The format of the map file read:
{{{
nx ny nz n
comment line
l1 l2 l3 k id
...
}}}

The first line: _nx_, _ny_, and _nz_ are the number of extensions of the unit cell in _x_, _y_, and _z_ directions, respectively. That is to say, your simulation box contains _nx_ x _ny_ x _nz_ unit cells. And _n_ is the number of atoms in each unit cell.

The second line: comment line, put whatever you want.
From line 3 to line (nx`*`ny`*`nz`*`n+2): _l1_, _l2_, _l3_ are the indices of the unit cell which atom _id_ belongs to, and atom _id_ is the _k_th atom in this unit cell.

= Details =
Suppose the basis vectors of your unit cell is *a*_1_, *a*_2_, and *a*_3_, and there are _n_ atoms in the unit cell, the position of the _k_-th atom in the unit cell is

*r*`[`k`]` = sx`[`k`]*` *a*_1_ + sy`[`k`]*` *a*_2_ + sz`[`k`]*` *a*_3_.

Consequently for an atom _id_, its equilibrium position might be:

x`[`id`]` = ( l1 + sx`[`k`]` ) `*` *a*_1_;

y`[`id`]` = ( l2 + sy`[`k`]` ) `*` *a*_2_;

z`[`id`]` = ( l3 + sz`[`k`]` ) `*` *a*_3_;

where _l1_ goes from _0_ to _nx-1_, and so forth.
Therefore, the four numbers (_l1, l2, l3, k)_ is mapped to the atom _id_ uniquely.

----

I have a code to generate the position file as well as the map file simultaneously, one can get it via svn:

[http://code.google.com/p/latgen/source/checkout latgen]

But no support will be provided to this code. Generally, one chooses the respective primitive cell to generate the position file and then calculate the phonon dispersions.